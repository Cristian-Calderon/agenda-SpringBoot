<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Agenda Mensual por Sala</title>
    <link rel="stylesheet" th:href="@{/styles.css}" />
    <style>
        .ocupado { background-color: #ccc; } /* gris para reservado/cerrado */
        .libre   { background-color: #fff; }
        table { border-collapse: collapse; margin-bottom: 2em; }
        th, td { border: 1px solid #999; width: 2em; text-align: center; }
        th.hour, td.hour { width: 3em; }
        h2, h3 { margin-top: 1em; }
    </style>
</head>
<body>
<h1>Planificación Mensual de Espacios</h1>

<div th:each="salaAg : ${resultado.salas}">
    <!-- Nombre de la sala -->
    <h2 th:text="${salaAg.sala}">Sala X</h2>

    <!-- Para cada semana del mes -->
    <div th:each="week : ${salaAg.semanas}">
        <h3 th:text="'Semana desde ' + ${#temporals.format(week.start, 'dd/MM/yyyy')}">
            Semana
        </h3>

        <table>
            <thead>
            <tr>
                <th class="hour">Hora</th>
                <!-- Días de la semana -->
                <th th:each="day : ${T(java.time.DayOfWeek).values()}"
                    th:text="${day.getDisplayName(T(java.time.format.TextStyle).SHORT, #locale)}">
                    D
                </th>
            </tr>
            </thead>
            <tbody>
            <!-- Filas horas 0–23 -->
            <tr th:each="h : ${#numbers.sequence(0,23)}">
                <td class="hour" th:text="${h + ':00'}">00:00</td>
                <!-- Una celda por día -->
                <td th:each="day : ${T(java.time.DayOfWeek).values()}"
                    th:classappend="${week.actividad.get(day)[h]} != null ? 'ocupado' : 'libre'">
                    <span th:text="${week.actividad.get(day)[h]}"> </span>
                </td>

            </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Incidencias al pie -->
<h2>Incidencias Detectadas</h2>
<ul>
    <li th:each="inc : ${resultado.incidencias}"
        th:text="${inc.descripcion}">[Descripción]</li>
</ul>
</body>
</html>
